<script src="{{ "custom-video.js" | asset_url }}" defer></script>
{{ "custom-video.css" | asset_url | stylesheet_tag }}

{% assign image = section.settings.image %}
{% assign heading = section.settings.heading %}
{% assign text = section.settings.text %}
{% assign html_desktop_video = section.settings.html_desktop_video %}
{% assign youtube_vimeo_desktop_url = section.settings.youtube_vimeo_desktop_url %}
{% assign video_position_type = section.settings.video_position_type %}

{% if html_desktop_video != blank or youtube_vimeo_desktop_url != blank %}
  <section class="custom-section page-width">
    {% if heading != blank or text != blank %}
      <div class="custom-video__text-wrapper">
        {% if heading != blank %}
          <h2 class="custom-video__heading">{{ heading }}</h2>
        {% endif %}

        {% if text != blank %}
          <div class="custom-video__text">{{ text }}</div>
        {% endif %}
      </div>
    {% endif %}

    <div class="custom-video__modal custom-video__modal--hidden js-custom-video-modal"
         data-video-position-type="{{ video_position_type }}">
      <div class="custom-video__modal-cnt custom-video__wrapper">
        {% if section.settings.video_type == "html" %}
          <video class="custom-video js-custom-video"
                 poster="{% if image != blank %}{{ image | image_url }}{% else %}{{ "image-placeholder.jpeg" | asset_url }}{% endif %}">
            {% for video_source in html_desktop_video.sources %}
              <source
                src="{{ video_source.url }}"
                type="{{ video_source.mime_type }}"
              />
            {% endfor %}

            Your browser doesn't support HTML5 video tag.
          </video>
        {% else %}
          {% if image != blank %}
            <picture class="custom-video__iframe-poster-wrapper">
              <source
                srcset="{{ image | image_url: width: 343, height: 193 }} 1x, {{ image | image_url: width: 686, height: 386 }} 2x"
                media="(max-width: 749px)">

              <img class="custom-video__iframe-poster js-custom-video-iframe-poster"
                   srcset="{{ image | image_url: width: 1368, height: 769 }} 1x, {{ image | image_url: width: 2736, height: 1538 }} 2x"
                   src="{{ image | image_url: width: 1368, height: 769 }}"
                   alt="{{ image.alt }}">
            </picture>
          {% else %}
            <div class="custom-video__iframe-poster-wrapper">
              {{ "blog-apparel-3" | placeholder_svg_tag }}
            </div>
          {% endif %}

          <iframe class="custom-video__iframe js-custom-video-iframe" width="100%" height="100%"
                  src="{{ youtube_vimeo_desktop_url }}" allow="autoplay">Your browser doesn't support iframes
          </iframe>
        {% endif %}

        <button class="custom-video__play-btn js-custom-video-play-btn">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M2.6665 8.00001V5.62668C2.6665 2.68001 4.75317 1.47334 7.3065 2.94668L9.3665 4.13334L11.4265 5.32001C13.9798 6.79334 13.9798 9.20668 11.4265 10.68L9.3665 11.8667L7.3065 13.0533C4.75317 14.5267 2.6665 13.32 2.6665 10.3733V8.00001Z"
              fill="black"/>
          </svg>
          Play video
        </button>
      </div>
    </div>
  </section>
{% endif %}

{% schema %}
{
  "name": "Custom video",
  "settings": [
    {
      "id": "video_position_type",
      "type": "select",
      "options": [
        {
          "value": "popup",
          "label": "Popup"
        },
        {
          "value": "inline",
          "label": "Inline"
        }
      ],
      "label": "Video type"
    },
    {
      "id": "heading",
      "type": "text",
      "label": "Heading"
    },
    {
      "id": "text",
      "type": "richtext",
      "label": "Text"
    },
    {
      "id": "image",
      "type": "image_picker",
      "label": "Image"
    },
    {
      "type": "header",
      "content": "Video"
    },
    {
      "id": "video_type",
      "type": "select",
      "options": [
        {
          "value": "youtube_vimeo",
          "label": "Youtube/Vimeo"
        },
        {
          "value": "html",
          "label": "HTML5"
        }
      ],
      "label": "Video type",
      "default": "youtube_vimeo"
    },
    {
      "id": "html_desktop_video",
      "type": "video",
      "label": "HTML5 desktop video"
    },
    {
      "id": "youtube_vimeo_desktop_url",
      "type": "url",
      "label": "Youtube/Vimeo desktop video url"
    }
  ],
  "presets": [
    {
      "name": "Custom video"
    }
  ]
}
{% endschema %}
